<!DOCTYPE html>


<html>



<head>
{% load staticfiles %}
{% load static %}
{% get_static_prefix as STATIC_PREFIX %}

<link rel="stylesheet" type="text/css" href="{% static 'css/style.css' %}" />

</head>

<body id="locus_body">
<div id="container">


        {% if no_match %}

            <div id="content">
                <div id="sidebar">
                    {% include "chlamdb/menu.html" %}
                </div>
                <div id="header">
                    {% include "chlamdb/user.html" %}
                </div>
                <div class="alert alert-warning" role="alert" style="width:50%"><a>{{fam}} not present in the database</a>
                </div>
            </div>

       {% else %}
           <div id="content">
               {%  if menu %}

                    <div id="sidebar">
                        {% include "chlamdb/menu.html" %}
                    </div>
                    <div id="header">
                        {% include "chlamdb/user.html" %}
                    </div>
               {% endif %}

                   <h3>{{ fam }}  {% if type == 'ko' %} <button type="button" class="btn btn-primary btn-xs"
                                                                onclick="location.href='{% url 'ko2fasta' fam %}'">ko fasta</button>
                                                        <button type="button" class="btn btn-primary btn-xs"
                                                                onclick="location.href='{% url 'ko2fasta' fam "T" %}'"> ko fasta + homologs</button>
                                       {%endif%}
                   </h3>
                    <ul id="tabs" class="nav nav-tabs" data-tabs="tabs">
                        <li class="active"><a href="#tab1" data-toggle="tab">General</a></li>
                        <li><a href="#tab2" data-toggle="tab">Details</a></li>
                        <li><a href="#tab3" data-toggle="tab">Profile</a></li>
                        {% if type == 'cog' %}
                            <li><a href="#tab66" data-toggle="tab" onclick="window.open('http://www.ncbi.nlm.nih.gov/Structure/cdd/cddsrv.cgi?uid={{ fam }}', 'orthoIDframe2'); return false">Informations</a></li>
                            <li><a href="#tab66" data-toggle="tab" onclick="window.open('{% url 'eggnog_profile' fam 'phylum' %}', 'orthoIDframe2'); return false">Taxonomic profile (phylum)</a></li>
                            <li><a href="#tab66" data-toggle="tab" onclick="window.open('{% url 'eggnog_profile' fam 'order' %}', 'orthoIDframe2'); return false">Taxonomic profile (order)</a></li>
                        {% elif type == 'pfam' %}
                            <li><a href="#tab66" data-toggle="tab" onclick="window.open('http://pfam.xfam.org/family/{{ fam }}', 'orthoIDframe2'); return false">Informations</a></li>
                            <li><a href="#tab66" data-toggle="tab" onclick="window.open('{% url 'pfam_profile' fam 'phylum' %}', 'orthoIDframe2'); return false">Taxonomic profile (phylum)</a></li>
                            <li><a href="#tab66" data-toggle="tab" onclick="window.open('{% url 'pfam_profile' fam 'order' %}', 'orthoIDframe2'); return false">Taxonomic profile (order)</a></li>
                        {% elif type == 'interpro' %}
                            <li><a href="#tab66" data-toggle="tab" onclick="window.open('http://www.ebi.ac.uk/interpro/entry/{{ fam }}', 'orthoIDframe2'); return false">Informations</a></li>
                        {% endif %}
                    </ul>

                    <div id="my-tab-content" class="tab-content">
                        <div class="tab-pane active" id="tab1">



                            <ol>
                                {% if type == 'EC' %}
                                    <table>

                                        {% for key, value in info%}
                                            <tr>
                                            <td><strong>{{key}}</strong></td><td>{{value}}</td>
                                            </tr>
                                        {% endfor %}


                                    </table>
                                    <li><a href="{{ external_link }}">External link</a></li>
                                {% elif type == 'ko'%}

                                    <li><strong>Name:</strong> {{ ko_data.1 }}</li>
                                    <li><strong>Description:</strong> {{ ko_data.2 }}</li>
                                    <li><strong>EC:</strong> {{ ko_data.3 }}</li>

                                {% else %}
                                    <li>{{ info.1 }} {{ info.0 }}</li>
                                {% endif %}


                                <li>{{ fam }} is present in <strong>{{ all_locus_data|length }} copies</strong></li>
                                <li>{{ fam }} is present in <strong>{{ group_count|length }} different orthogroup(s)</strong></li>


                                <ul>
                                    {% for group in group_count %}
                                    <li><a href="{% url 'locusx' group True%}">{{group}}</a></li>
                                    {% endfor %}
                                </ul>
                            {% if type == 'EC' %}
                                <li>EC present in <strong>{{pathway_data|length }} pathways</strong></li>
                                <ul>
                                    {% for path in pathway_data %}
                                    <li><a href="{% url 'KEGG_mapp' path.0 %}">{{path.2}} :: {{path.1}}</a></li>
                                    {% endfor %}


                                </ul>
                            {% elif type == 'ko' %}

                                <li>KO part of <strong>{{pathway_data|length }} pathways</strong></li>
                                <ul>
                                    {% for path in pathway_data %}
                                    <li><a href="{% url 'KEGG_mapp_ko' path.0 %}">{{path.0}} :: {{path.1}}</a></li>
                                    {% endfor %}
                                </ul>
                                <li>KO part of <strong>{{module_data|length }} modules</strong></li>
                                <ul>
                                    {% for path in module_data %}
                                    <li><a href="{% url 'KEGG_module_map' path.0 %}">{{path.2}} :: {{path.1}}</a></li>
                                    {% endfor %}
                                </ul>

                            {% endif %}

                            {% if type == 'cog' %}
                                <li>Extrenal link: <a href="http://www.ncbi.nlm.nih.gov/Structure/cdd/cddsrv.cgi?uid={{ fam }}">{{ fam }}</a></li>
                            {% elif type == 'pfam' %}
                                <li>Extrenal link: <a href="http://pfam.xfam.org/family/{{ fam }}">{{ fam }}</a></li>
                            {% elif type == 'interpro' %}
                                <li>Extrenal link: <a href="http://www.ebi.ac.uk/interpro/entry/{{ fam }}">{{ fam }}</a></li>
                            {% elif type == 'ko' %}
                                <li>Extrenal link: <a href="http://www.genome.jp/dbget-bin/www_bget?{{ fam }}">{{ fam }}</a></li>
                            {% endif %}

                            </ol>
                        </div>
                        <div class="tab-pane" id="tab2">

                            <div id="export_bouttons">
                                <a download="locus_{{ data.1 }}.xls" href="#" onclick="return ExcellentExport.excel(this, 'search_table', 'search');" style="background-color:#DCFFF0;color:black;padding:2px;border:1px solid black;">Export to Excel</a>
                                <a download="locus{{ data.1 }}.csv" href="#" onclick="return ExcellentExport.csv(this, 'search_table');" style="background-color:#DCFFF0;color:black;padding:2px;border:1px solid black;">Export to CSV</a>
                                <br/>
                            </div>

                            <table id="search_table" class="sortable">
                                <h3>Detail</h3>
                                <thead>
                                    <tr>
                                    <th></th>
                                    <th id="entete_locus">Orthogroup</th>
                                    <th id="entete_locus">Locus</th>
                                    <th id="entete_locus">Protein id</th>
                                    <th id="entete_gene">Start</th>
                                    <th id="entete_gene">Stop</th>
                                    <th id="entete_strand">S.</th>
                                    <th id="entete_gene">Gene</th>
                                    <th id="entete_n">nH</th>
                                    <th id="entete_n">nG</th>
                                    <th id="entete_n">TM</th>
                                    <th id="entete_n">SP</th>
                                    <th id="entete_product">Product</th>
                                    <th id="entete_organism">Organism</th>
                                    <th id="entete_translation">Translation</th>

                                    </tr>
                                </thead>
                                <tbody>

                                    {% load static %}
                                    {% get_static_prefix as STATIC_PREFIX %}

                                    {% for values in all_locus_data %}
                                        <tr>
                                        <td>{{values.0}}</td>

                                        <td>{{values.1}}</td>
                                        <td><a href='{% url "locusx" values.2 True %}' target="_top">{{values.2}}</a></td>
                                        <td><a href="http://www.ncbi.nlm.nih.gov/protein/{{values.3}}">{{values.3}}</td>
                                        <td>{{values.4}}</td>
                                        <td>{{values.5}}</td>
                                        <td>{{values.6}}</td>
                                        <td>{{values.7}}</td>
                                        <td>{{values.8}}</td>
                                        <td>{{values.9}}</td>
                                        <td>{{values.10}}</td>
                                        <td>{{values.11}}</td>
                                        <td>{{values.12}}</td>
                                        <td>{{values.13}}</td>
                                        <td><a href="{% url "blastnr" values.2  %}">{{values.14}}</a></td>
                                        </tr>
                                    {% endfor %}
                                    </tbody>
                            </table>
                        </div>

                        <div class="tab-pane" id="tab66" style="height:100%">
                                <iframe name="orthoIDframe2" id="orthoIDframe2" scrolling="no" width="100%" height="2800px"></iframe>
                        </div>



                        <div class="tab-pane" id="tab3">
                             <div class="panel panel-success" style="width:80%; top: 200px; margin: 10px 10px 10px 10px">
                                <div class="panel-heading" style="width:100%">
                                    <h3 class="panel-title">Help</h3>
                                </div>
                                <p style="margin: 10px 10px 10px 10px; line-height: 180%">
                                    Table of Kegg maps. <br>
                                    <strong>Red:</strong> <font size="2" color="red">{{type}}</font> <font size="2" color="red">with</font> positive hit(s) in the corresponding genome. <br>
                                    <strong>Green:</strong>Highlight discrepencies between orthogroup clustering and <font size="2" color="red">{{type}}</font> prediction. Green homologs (same orthogroup) <font size="2" color="green">are not</font> positive hit(s) for the considered <font size="2" color="red">{{type}}</font>. Variations within orthogroups may be due to the clustering of multi domain proteins or because of erroneous homolog clustering or <font size="2" color="red">{{type}}</font> prediction.
                                </p>
                             </div>
                            {% if not big %}
                            <object type="image/svg+xml" data="{% static asset_path %}" id="cog_tree"></object>
                            {% else %}
                            <img src="{% static asset_path %}" alt="profile" style="width:100%;">
                            {% endif %}
                        </div>
                    </div>
           </div>
       {% endif %}
</div>


</body>
</html>
