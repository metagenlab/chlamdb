<!DOCTYPE html>


<html>



<head>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-125948409-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-125948409-1');
</script>

{% load staticfiles %}
{% load static %}
{% load custom_tags %}
{% get_static_prefix as STATIC_PREFIX %}
<script>
function clearBox(elementID)
{
    document.getElementById(elementID).innerHTML = "";
}
</script>

{% include "chlamdb/header.html" %}

</head>




{% if not menu %}
    <div class="container-fluid" id="container_no_margin" height="100%">

{% else %}
<div class="container-fluid" id="main_container">
{% endif %}
  <div class="row">
    <div id="wrapper">
      <div id="page-content-wrapper">
        <div class="row">
          <div class="col-lg-12">

          {% if menu %}
              {% include "chlamdb/menu.html" %}
          {% endif %}
          {% if not valid_id %}
              <div class="alert alert-warning" role="alert" style="width:50%"><a>Unknown accession! Accept protein ids, locus tags and orthogroup IDs</a></div>
              <p>
         {% else %}

            <ul id="tabs" class="nav nav-tabs" data-tabs="tabs">

                {%if input_type != 'orthogroup' %}
                <li class="active" id="main_overview"><a href="#tab1" data-toggle="tab">Overview</a></li>
                <li><a href="#tab3" data-toggle="tab">Sequences</a></li>
                <li><a href="#tab2" data-toggle="tab">InterproScan</a></li>
                <li><a href="#tab33" data-toggle="tab">Homologs <span class="badge">{{homologues|length}}</span><br></a></li>
                {% else %}
                 <li class="active"><a href="#tab33" data-toggle="tab">Homologs <span class="badge">{{homologues|length}}</span><br></a></li>
                {% endif %}

                {% if input_type == 'locus_tag'%}
                <li><a href="#tab66" data-toggle="tab" onclick="window.open('{% url 'orthogroup_conservation_tree' locus %}', 'orthoIDframe'); return false">Phylogenetic distribution</a></li>
                {%else%}
                <li><a href="#tab66" data-toggle="tab" onclick="window.open('{% url 'orthogroup_conservation_tree' data.0 %}', 'orthoIDframe'); return false">Phylogenetic distribution</a></li>
                {%endif%}

                {% if align_path %}
                <li><a href="#tab55" data-toggle="tab">MSA</a></li>
                {% endif %}
                <li><a href="#tab66" data-toggle="tab" onclick="window.open('{% url 'orthogroup_identity' data.0 True %}', 'orthoIDframe'); return false">Orthogroup conservation</a></li>
                {% if homologues|length > 3%}
                    <li><a href="#tab66" data-toggle="tab" onclick="window.open('{% url 'pfam_tree' data.0 %}', 'orthoIDframe'); return false">Pfam tree</a></li>
                {% endif %}
                {% if show_tm_tree %}
                    <li><a href="#tab66" data-toggle="tab" onclick="window.open('{% url 'TM_tree' data.0 %}', 'orthoIDframe'); return false">TM tree</a></li>
                {% endif %}

                <!--{% if cog_data %}
                <li><a href="#tab66" data-toggle="tab" onclick="window.open('{% url 'string_page' cog_data.0 genome_accession %}', 'orthoIDframe'); return false">string interactions</a></li>
                {% endif %}-->
                <li><a href="#tab66" data-toggle="tab" onclick="window.open('{% url 'plot_neighborhood' data.1 %}', 'orthoIDframe'); return false">Region</a></li>
                <li><a href="#tab66" data-toggle="tab" onclick="window.open('{% url 'blastnr' data.1 %}', 'orthoIDframe'); return false">Blast RS <span class="badge">{{n_blastnr_hits}}</span></a></li>
                <li><a href="#tab66" data-toggle="tab" onclick="window.open('{% url 'blastswissprot' data.1 %}', 'orthoIDframe'); return false">Blast SP <span class="badge">{{n_swissprot_hits}}</span></a></li>
                <li><a href="#tab66" data-toggle="tab" onclick="window.open('{% url 'interactions' data.1 %}', 'orthoIDframe'); return false">Interactions</a></li>
                {%if closest_phylo%}
                <li><a href="#tab66" data-toggle="tab" onclick="window.open('{% url 'refseq_swissprot_tree' data.0 %}', 'orthoIDframe'); return false">BBH phylogeny</a></li>
                {%endif %}
                <li><a href="#tab66" data-toggle="tab" onclick="window.open('{% url 'hydropathy' data.1 %}', 'orthoIDframe'); return false">Hydropathy plot</a></li>
                <!--<li><a href="#tab66" data-toggle="tab" onclick="window.open('{% url 'aa_comp_locus' data.1 %}', 'orthoIDframe'); return false">AA composition PCA</a></li>-->
                <li><a href="#tab66" data-toggle="tab" onclick="window.open('{% url 'gc_locus' data.1 %}', 'orthoIDframe'); return false">GC</a></li>
                {% if pubmed_data  %}
                <li><a href="#tab22" data-toggle="tab">Pubmed  <span class="badge">{{pubmed_data|length}}</span></a></li>
                {%endif %}


            </ul>
            <div id="my-tab-content" class="tab-content">
            {% if input_type != 'orthogroup' %}


                <div class="tab-pane active" id="tab1" style="padding-left: 15px;padding-top:20px">
                        <div class="col-md-4">
                          <div class="container-fluid">
                            <div class="row">
                              <div class="panel panel-default">
                                <div class="panel-heading">
                                  <h3 class="panel-title">General</h3>
                                </div>
                                  <table class="table-striped" style="width: 100%">

                                      <tr>
                                          <th id="description_field">Organism</th>
                                          <td>{{ data.12 }}</td>
                                      </tr>
                                      <tr>
                                          <th id="description_field">locus_tag</th>
                                          <td>{{ data.1 }}</td>
                                      </tr>
                                      {% if old_locus_tag %}
                                          <tr>
                                              <th id="description_field">old locus_tag</th>
                                              <td>{{ old_locus_tag }}</td>
                                          </tr>
                                      {% endif %}
                                      <th  id="description_field">gene</th>
                                          <td>{{ data.6 }}</td>
                                      </tr>
                                      <tr>
                                          <th>protein_id</th>
                                          <td>{{ data.2 }}</td>
                                      </tr>
                                      <tr>
                                          <th>Location</th>
                                          <td>{{ data.3 }} - {{ data.4 }} (strand: {{ data.5 }})</td>
                                      </tr>

                                      <tr>
                                          <th>Length</th>
                                          <td>{{ nucl_length }} (nucleotides) / {{aa_length}} (amino acids)</td>
                                      </tr>
                                  </table>
                              </div>
                            </div>

                            <div class="row">
                              <div class="panel panel-default">
                                <div class="panel-heading">
                                  <h3 class="panel-title">Download</h3>
                                </div>
                                <div class="panel-body">
                                  <div style="width: 100%;padding-left:20px">
                                      <button type="button" class="btn btn-primary btn-xs" onclick="location.href='{% url 'get_orthogroup_fasta' data.0 "aa"%}'">fasta aa</button>
                                      <button type="button" class="btn btn-primary btn-xs" onclick="location.href='{% url 'get_orthogroup_fasta' data.0 "nucl"%}'">fasta nucl</button>
                                      <button type="button" class="btn btn-primary btn-xs" onclick="location.href='{% url 'get_newick_tree' data.0 %}'">newick tree</button>
                                      <button type="button" class="btn btn-primary btn-xs" onclick="location.href='{% static alignment_fasta %}'">MSA</button>
                                  </div>
                                </div>
                              </div>
                           </div>
                           <div class="row">
                             <div class="panel panel-default">
                               <div class="panel-heading">
                                 <h3 class="panel-title">Orthology</h3>
                               </div>

                                 <table class="table-striped" style="width: 100%">
                                   <tr>
                                       <td id="description_field">orthogroup</td>
                                       <td>{{ data.0 }}</td>
                                   </tr>
                                   <td id="description_field">orthogroup size</td>
                                       <td>{{ data.7 }}</td>
                                   </tr>

                                   <td id="description_field">n genomes</td>
                                       <td>{{ data.8 }}</td>
                                   </tr>
                                   {%if cog_data %}
                                       <tr>
                                       <td id="description_field"><a href="{% url 'fam' cog_data.0 'cog' %}" target="_top">COG <a href="#" data-delay='{"show":"50", "hide":"1000"}' data-toggle="tooltip" title="Click to see the occurence of this COG in the database."><span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span></a></a></td>
                                       <td><a href="http://www.ncbi.nlm.nih.gov/Structure/cdd/cddsrv.cgi?uid={{cog_data.0}}"  target="_top">{{cog_data.0}}: {{cog_data.2}} ({{cog_data.1}})</a></td>
                                       </tr>
                                   {% endif %}
                                   {%if ko_data %}
                                       <tr>
                                       <td id="description_field"><a href="{% url 'fam' ko_data.0 'ko' %}" target="_top">KO <a href="#" data-delay='{"show":"50", "hide":"1000"}' data-toggle="tooltip" title="Click to see the occurence of this Kegg Ortholog in the database."><span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span></a></a></td>
                                       <td><a href="http://www.genome.jp/dbget-bin/www_bget?ko:{{ko_data.0}}"  target="_top">{{ko_data.0}}: {{ko_data.1}}, {{ko_data.2}}</a></td>
                                       </tr>
                                   {% endif %}
                                </table>

                             </div>
                           </div>

                            {% if protparams_data %}
                            <div class="row">
                              <h3>ProtParams</h3>
                              <div style="width: 100%;padding-left:20px">
                                  <table>
                                      <tr>
                                          <td id="description_field">Molecular Weight</td>
                                          <td>{{protparams_data.0}}</td>
                                      </tr>
                                      <tr>
                                          <td id="description_field">Isoelectric Point</td>
                                          <td>{{protparams_data.1}}</td>
                                      </tr>
                                      <tr>
                                          <td id="description_field">Aromaticity</td>
                                          <td>{{protparams_data.2}}</td>
                                      </tr>
                                      <tr>
                                          <td id="description_field">Instability Index</td>
                                          <td>{{protparams_data.3}}</td>
                                      </tr>
                                      <tr>
                                          <td id="description_field">Fractions helix/turn/sheet</td>
                                          <td>{{protparams_data.4}}/{{protparams_data.5}}/{{protparams_data.6}}</td>
                                      </tr>

                                  </table>
                              </div>
                            </div>
                            {% endif %}
                            <div class="row">
                              <h3>Orthogroup {{ data.0 }} Annotation</h3>
                              <div style="width: 100%;padding-left:20px">
                                  <table>
                                      <tr>
                                      <td id="description_field">Comment orthogroup   <a href="{% url 'add_comment' data.1 %}">  edit</a></td>
                                      <td>
                                          {% for values in cmt_format%}
                                              {{values.0}}: {{values.1|safe}} </br>
                                          {% endfor %}
                                       </td>
                                      </tr>

                                  </table>
                              </div>
                            </div>




                            {%if dbxref_uniprot_data %}
                              <div class="row">
                                <h3>References</h3>
                                <div style="width: 100%;padding-left:20px">

                                        <table>
                                            {% for xref in dbxref_uniprot_data%}
                                            <tr>
                                                <td>{{xref.0}}</td>
                                                {% if xref.0 == 'Swiss-Prot'%}
                                                <td><a href="http://www.uniprot.org/uniprot/{{xref.1}}"  target="_top">{{xref.1}}</a></td>
                                                {% elif xref.0 == 'KEGG'%}
                                                <td><a href="http://www.genome.jp/dbget-bin/www_bget?{{xref.1}}"  target="_top">{{xref.1}}</a></td>
                                                {% elif xref.0 == 'PATRIC'%}
                                                <td><a href="http://patricbrc.org/portal/portal/patric/Feature?cType=feature&cId={{xref.1}}"  target="_top">{{xref.1}}</a></td>
                                                {% elif xref.0 == 'STRING'%}
                                                <td><a href="http://string-db.org/newstring_cgi/show_network_section.pl?identifier={{xref.1}}"  target="_top">{{xref.1}}</a></td>
                                                {% elif xref.0 == 'OrthoDB'%}
                                                <td><a href="http://www.orthodb.org/?query={{uniprot_accession}}"  target="_top">{{xref.1}}</a></td>
                                                {% elif xref.0 == 'eggNOG'%}
                                                <td><a href="http://eggnogdb.embl.de/#/app/results?seqid={{uniprot_accession}}&target_nogs={{xref.1}}"  target="_top">{{xref.1}}</a></td>
                                                {% elif xref.0 == 'CDD'%}
                                                <td><a href="https://www.ncbi.nlm.nih.gov/Structure/cdd/cddsrv.cgi?uid={{xref.1}}"  target="_top">{{xref.1}}</a></td>
                                                {% elif xref.0 == 'HAMAP'%}
                                                <td><a href="http://hamap.expasy.org/profile/{{xref.1}}"  target="_top">{{xref.1}}</a></td>
                                                {% elif xref.0 == 'EMBL'%}
                                                <td><a href="https://www.ncbi.nlm.nih.gov/protein/{{xref.1}}"  target="_top">{{xref.1}}</a></td>
                                                {% elif xref.0 == 'ProteinModelPortal'%}
                                                <td><a href="http://www.proteinmodelportal.org/query/uniprot/{{xref.1}}"  target="_top">{{xref.1}}</a></td>
                                                {% elif xref.0 == 'PROSITE'%}
                                                <td><a href="http://prosite.expasy.org/doc/{{xref.1}}"  target="_top">{{xref.1}}</a></td>
                                                {% elif xref.0 == 'OMA'%}
                                                <td><a href="http://omabrowser.org/cgi-bin/gateway.pl?f=DisplayGroup&p1={{xref.1}}"  target="_top">{{xref.1}}</a></td>
                                                {% elif xref.0 == 'NCBI Taxonomy'%}
                                                <td><a href="https://www.ncbi.nlm.nih.gov/Taxonomy/Browser/wwwtax.cgi?lvl=0&id={{xref.1}}"  target="_top">{{xref.1}}</a></td>
                                                {% elif xref.0 == 'EnsemblBacteria'%}
                                                <td><a href="http://ensemblgenomes.org/id/{{xref.1}}"  target="_top">{{xref.1}}</a></td>
                                                {% elif xref.0 == 'HOGENOM'%}
                                                <td><a href="http://pbil.univ-lyon1.fr/cgi-bin/acnuc-ac2tree?query={{uniprot_accession}}&db=HOGENOM"  target="_top">{{xref.1}}</a></td>
                                                {% elif xref.0 == 'PubMed'%}
                                                <td><a href="https://www.ncbi.nlm.nih.gov/pubmed/{{xref.1}}"  target="_top">{{xref.1}}</a></td>
                                                {% elif xref.0 == 'Proteomes'%}
                                                <td><a href="http://www.uniprot.org/proteomes/{{xref.1}}"  target="_top">{{xref.1}}</a></td>
                                                {% elif xref.0 == 'SUPFAM'%}
                                                <td><a href="http://supfam.org/SUPERFAMILY/cgi-bin/scop.cgi?ipid={{xref.1}}"  target="_top">{{xref.1}}</a></td>
                                                {% elif xref.0 == 'TIGRFAMs'%}
                                                <td><a href="http://www.jcvi.org/cgi-bin/tigrfams/HmmReportPage.cgi?acc={{xref.1}}"  target="_top">{{xref.1}}</a></td>
                                                {% elif xref.0 == 'RefSeq'%}
                                                <td><a href="https://www.ncbi.nlm.nih.gov/protein/{{xref.1}}"  target="_top">{{xref.1}}</a></td>


                                                {% else %}
                                                <td>{{xref.1}}</td>
                                                {% endif %}
                                            </tr>
                                            {% endfor %}

                                        </table>
                                </div>
                              </div>
                            {% endif %}

                        </div> <!-- fluid container -->
                      </div> <!-- column -->
                      <div class="col-md-8">
                            <div class="row" style="height:100px">
                                <object width="95%"  type="image/svg+xml" style="margin-left: -30px" data="{% static name %}" id="genomic_region"></object>
                            </div>
                            <div style="padding-top:40px;">
                              <div class="row">
                                    <div class="panel panel-default">
                                      <div class="panel-heading">
                                        <h3 class="panel-title">Product</h3>
                                      </div>
                                      <table class="table-striped" style="width: 100%">
                                          <tr>
                                              <td id="description_field">Product</td>
                                              <td>{{ data.11 }}</td>

                                              {%if uniprot_id %}
                                              <tr>
                                                <td>Annotation evidence</td>
                                                <td><a href="http://www.uniprot.org/uniprot/{{uniprot_id}}" target="_top">BLast VS Uniprot: {{uniprot_id}}</a></td>
                                              </tr>
                                              {% endif %}


                                          </tr>
                                      </table>
                                    </div>
                              </div>
                            </div>
                            {% if uniprot_annotation%}
                              <div class="row">
                                <div class="panel panel-default">
                                  <div class="panel-heading">
                                    <h3 class="panel-title">Uniprot Annotation</h3>
                                  </div>
                                  <table class="table-striped" style="width: 100%">
                                          <tr>
                                              <td id="description_field">Uniprot status</td>
                                              <td><strong>{{ uniprot_annotation.0 }} / Score: {{ uniprot_annotation.1 }}</strong></td>
                                          </tr>

                                      {%if uniprot_annotation.2 != '-'%}
                                          <tr>
                                              <td id="description_field">gene</td>
                                              <td>{{ uniprot_annotation.2 }}</td>
                                          </tr>
                                      {% endif %}
                                      {%if uniprot_annotation.3 != '-'%}
                                          <tr>
                                              <td id="description_field">product</td>
                                              <td>{{ uniprot_annotation.3 }}</td>
                                          </tr>
                                      {% endif %}
                                      {%if uniprot_annotation.4 != '-'%}
                                          <tr>
                                              <td id="description_field">function</td>
                                              <td>{{ uniprot_annotation.4 }}</td>
                                          </tr>
                                      {% endif %}
                                      {%if uniprot_annotation.5 != '-'%}
                                          <tr>
                                              <td id="description_field">ec_number</td>
                                              <td>{{ uniprot_annotation.5 }}</td>
                                          </tr>
                                      {% endif %}

                                      {%if uniprot_annotation.6 != '-'%}
                                          <tr>
                                              <td id="description_field">similarity</td>
                                              <td>{{ uniprot_annotation.6 }}</td>
                                          </tr>
                                      {% endif %}
                                      {%if uniprot_annotation.7 != '-'%}
                                          <tr>
                                              <td id="description_field">subunit</td>
                                              <td>{{ uniprot_annotation.7 }}</td>
                                          </tr>
                                      {% endif %}
                                      {%if uniprot_annotation.8 != '-'%}
                                          <tr>
                                              <td id="description_field">catalytic activity</td>
                                              <td>{{ uniprot_annotation.8 }}</td>
                                          </tr>
                                      {% endif %}
                                  </table>
                                </div>
                              </div>
                            {%endif%}
                            {% if transporter_data%}
                            <div class="row">
                              <h3>Transporter</h3>

                              <table class="table-striped" style="width: 100%">
                                  <tr>
                                      <th>Hit</th>
                                      <th>Evalue</th>
                                      <th>Score</th>
                                      <th>Identity</th>
                                      <th>TM_query</th>
                                      <th>TM_hit</th>
                                      <th>query_cov</th>
                                      <th>hit_cov</th>
                                  </tr>
                                  <tr>
                                      <td>{{transporter_data.0}}</td>
                                      <td>{{transporter_data.1}}</td>
                                      <td>{{transporter_data.2}}</td>
                                      <td>{{transporter_data.3}}</td>
                                      <td>{{transporter_data.4}}</td>
                                      <td>{{transporter_data.5}}</td>
                                      <td>{{transporter_data.6}}</td>
                                      <td>{{transporter_data.7}}</td>
                                  </tr>

                              </table>
                              <table class="table-striped" style="width: 100%">

                                  <tr>
                                      <th style="width:80px">SuperFamily</th>
                                      <td style="width:70px"><a href="http://tcdb.org/search/result.php?tc={{transporter_data.10}}">{{transporter_data.10}}</a></td><td>{{transporter_data.11}}</td>
                                  </tr>
                                  <tr>
                                      <th>Family</th>
                                      <td><a href="http://tcdb.org/search/result.php?tc={{transporter_data.12}}">{{transporter_data.12}}</a></td><td>{{transporter_data.13}}</td>
                                  </tr>
                                  <tr>
                                      <th>Subfamily</th>
                                      <td><a href="http://tcdb.org/search/result.php?tc={{transporter_data.14}}">{{transporter_data.14}}</a></td><td>{{transporter_data.15}}</td>
                                  </tr>
                                  <tr>
                                      <th>Transporter</th>
                                      <td><a href="http://tcdb.org/search/result.php?tc={{transporter_data.14}}#{{transporter_data.8}}">{{transporter_data.8}}</a></td><td>{{transporter_data.9}}</td>
                                  </tr>
                              </table>
                            </div>
                            {% endif %}
                            <div class="row">
                              <div class="panel panel-default">
                                <div class="panel-heading">
                                  <h3 class="panel-title">Domains</h3>
                                </div>
                                <div>
                                  <div id="div_features" style="margin-top: 1px; width: 800px"></div>

                                  <table class="table-striped" style="width: 100%">
                                      {%if interpro_data %}
                                         <tr>
                                              <td style="width:70px"></td>
                                              <td style="width:300px"></td>
                                              <td style="width:90px">Bacteria <a href="#" data-delay='{"show":"50", "hide":"3000"}' data-toggle="tooltip" title="Number/fraction of bacterial sequences in Interproscan V.60 exhibiting this domain"><span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span></a></td>
                                              <td style="width:80px">Euk. <a href="#" data-delay='{"show":"50", "hide":"3000"}' data-toggle="tooltip" title="Number/fraction of eukaryotic sequences in Interproscan V.60 exhibiting this domain"><span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span></a></td>
                                              <td style="width:80px">Archae <a href="#" data-delay='{"show":"50", "hide":"3000"}' data-toggle="tooltip" title="Number/fraction of archaeal sequences in Interproscan V.60 exhibiting this domain"><span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span></a></td>
                                              <td style="width:80px">Virus <a href="#" data-delay='{"show":"50", "hide":"3000"}' data-toggle="tooltip" title="Number/fraction of virus sequences in Interproscan V.60 exhibiting this domain"><span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span></a></td>
                                          </tr>
                                      {% endif %}
                                      {%if pfam_data %}
                                          {% for values in pfam_data %}
                                              <tr>
                                                  <td id="description_field"><a href="{% url 'fam' values.0 'pfam' %}" target="_top">Pf: {{values.0}}</a></td>
                                                  <td>{{values.1}}</td>
                                              </tr>

                                          {% endfor %}
                                      {% endif %}

                                      {%if interpro_data %}
                                          {% for values in interpro_data %}
                                              {% with interpro2taxononmy|keyvalue:values.0 as taxo %}
                                              <tr>
                                                  <td id="description_field"><a href="{% url 'fam' values.0 'interpro' %}" target="_top">IP: {{values.0}}</a></td>
                                                  <td>{{values.1}} </td>
                                                  {% if taxo.4 > taxo.5 %}
                                                      <td style="color:blue;">{{taxo.4}} ({{taxo.0}}%)</td>
                                                      <td>{{taxo.5}} ({{taxo.1}}%)</td>
                                                  {% else %}
                                                      <td>{{taxo.4}} ({{taxo.0}}%)</td>
                                                      <td style="color:red;">{{taxo.5}} ({{taxo.1}}%)</td>
                                                  {% endif %}
                                                  <td>{{taxo.6}} ({{taxo.2}}%)</td>
                                                  <td>{{taxo.7}} ({{taxo.3}}%)</td>
                                              </tr>
                                              {% endwith %}
                                          {% endfor %}
                                      {% endif %}
                                  </table>
                                </div>
                              </div>
                            </div>

                            {%if ko_pathway_data or ko_module_data %}
                              <div class="row">
                                <div class="panel panel-default">
                                  <div class="panel-heading">
                                    <h3 class="panel-title">Pathways/Modules <a href="#" data-delay='{"show":"50", "hide":"3000"}' data-toggle="tooltip" title="Data obtained based on PRIAM and GhostKOALA"><span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span></a></h3>
                                  </div>
                                  <table class="table-striped" style="width: 100%">

                                      {%if ko_pathway_data %}

                                          {% for pathway in ko_pathway_data %}
                                              <tr>
                                                  <td>Pathway: {{pathway.1}} <a href="{% url 'KEGG_mapp_ko' pathway.1 %}" target="_top">ko</a> /
                                                      <a href="{% url 'KEGG_mapp' pathway.1 %}" target="_top">priam_ec</a> <a href="#" data-delay='{"show":"50", "hide":"1000"}' data-toggle="tooltip" title="Click on the pathway id to get the list and distribution of identified proteins in the database."><span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span></a></td>
                                                  <td>{{pathway.2}}</td>
                                                  <td>{{pathway.3}}</td>
                                              </tr>
                                          {% endfor %}


                                      {% endif %}
                                      {%if ko_module_data %}

                                          {% for module in ko_module_data %}
                                              <tr>
                                                  <td>Module: <a href="{% url 'KEGG_module_map' module.0 %}" target="_top">{{module.0}} (ko_based) </a> <a href="#" data-delay='{"show":"50", "hide":"1000"}' data-toggle="tooltip" title="Click on module id to get the list and distribution of identified proteins in the database."><span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span></a>
                                                  <td>{{module.1}}</td>
                                                  <td>{{module.2}}</td>
                                              </tr>
                                          {% endfor %}
                                      {% endif %}
                                  </table>
                                </div>
                              </div>

                            {% endif %}

                            {%if operon %}
                              <div class="row">
                                <h3>Operon <a href="#" data-delay='{"show":"50", "hide":"3000"}' data-toggle="tooltip" title="Data from the Door2 database"><span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span></a></h3>
                                <table class="table-striped" style="width: 100%">
                                    <tr>
                                        <th>DOOR2 id</th>
                                        <th>locus</th>
                                        <th>old_locus</th>
                                        <th>COG </th>
                                        <th>Product</th>
                                    </tr>
                                    {% for locus in operon %}

                                    <tr>
                                        <td><a href="http://csbl.bmb.uga.edu/DOOR/operon.php?id={{locus.0}}#basic">{{locus.0}}</a></td>
                                        {%if locus.2 != '-'%}
                                            <td><a href="{% url 'locusx' locus.2 True %}" target="_top">{{locus.2}}</a></td>
                                        {% else %}
                                            <td>{{locus.2}}</td>
                                        {% endif %}
                                        {%if locus.3 != '-'%}
                                            <td><a href="{% url 'locusx' locus.3 True %}" target="_top">{{locus.3}}</a></td>
                                        {% else %}
                                            <td>{{locus.3}}</td>
                                        {% endif %}
                                        <td>{{locus.4}}</td>
                                        <td>{{locus.5}}</td>
                                    </tr>
                                    {% endfor %}
                                </table>
                              </div>
                            {% endif %}
                            {%if operon_ofs %}
                              <div class="row">
                                <h3>Operon <a href="#" data-delay='{"show":"50", "hide":"3000"}' data-toggle="tooltip" title="Data predicted based on the method from Westover et al, 2004"><span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span></a></h3>
                                <table id="cog_table" class="sortable">
                                    <thead>
                                        <tr>
                                            <th></th>
                                            <th id="entete_locus">Locus</th>
                                            <th style="width:10px">C</th>
                                            <th style="width:160px">Pathways</th>
                                            <th style="width:260px">Interpro</th>
                                            <th id="entete_gene">Gene</th>
                                            <th id="entete_n">nH</th>
                                            <th id="entete_n">nG</th>
                                            <th id="entete_n">TM</th>
                                            <th id="entete_n">SP</th>
                                            <th id="entete_product">Product</th>


                                        </tr>
                                    </thead>
                                    <tbody>

                                        {%for values in locus2annot%}
                                        <tr>
                                            <td>{{values.0}}</td>
                                            <td><a href="{% url 'locusx' values.2 True %}" target="_top">{{values.2}}</a></td>
                                            <td><a href="http://www.ncbi.nlm.nih.gov/protein/{{values.3}}" target="_top">{{locus_tag2cog_catego|keyvalue:values.2}}</a></td>
                                            {% with locus_tag2ko|keyvalue:values.2 as oneko %}
                                                {% if oneko == '-' %}
                                                    <td>-</td>
                                                {% else %}
                                                    {% with ko2ko_pathways|keyvalue:oneko as name %}
                                                        {% if name == '-' %}
                                                            <td>-</td>
                                                        {% else %}
                                                            <td>{{name|safe}}</td>
                                                        {% endif %}
                                                    {%endwith%}
                                                {% endif %}

                                            {%endwith%}
                                            {% with locus2interpro|keyvalue:values.2 as interpro_data %}
                                            <td>
                                                {% for one_interpro in interpro_data %}
                                                {% if one_interpro.0 != '-' %}
                                                    <a href="{% url 'fam' one_interpro.0 'interpro' %}" target="_top">{{one_interpro.0}}</a> /
                                                {%else%}
                                                    {{one_interpro.0}}
                                                {%endif%}
                                                    {{one_interpro.1}} </br>
                                                {% endfor %}
                                                {%endwith%}
                                            </td>
                                            <td>{{values.7}}</td>
                                            <td>{{values.8}}</td>
                                            <td>{{values.9}}</td>
                                            <td>{{values.10}}</td>
                                            <td>{{values.11}}</td>
                                            <td>{{values.12}}</td>

                                        </tr>

                                        {%endfor%}
                                    </tbody>
                                </table>
                              </div>
                            {% endif %}

                            {% if uniprot_go_terms or interpro_go_terms%}
                              <div class="row">
                                <h3>Gene Ontology</h3>
                                <table class="sortable">
                                    <tr>
                                        <th>Accession</th>
                                        <th>Type</th>
                                        <th>Description</th>
                                    </tr>
                                    {% for go in uniprot_go_terms%}
                                        <tr>
                                            <td><a href="" target="_top">{{go.0}}</a> (source: uniprot)</td>
                                            <td>{{go.1}}</td>
                                            <td>{{go.2}}</td>
                                        </tr>
                                    {% endfor%}
                                    {% for go in interpro_go_terms%}
                                        <tr>
                                            <td><a href="" target="_top">{{go.0}}</a> (source: interpro)</td>
                                            <td>{{go.1}}</td>
                                            <td>{{go.2}}</td>
                                        </tr>
                                    {% endfor%}
                                </table>
                              </div>
                            {% endif %}
                            {% if rnaseq_data%}
                              <div class="row">
                                <h3>RNAseq data</h3>
                                <table class="sortable">
                                    <tr>
                                        <th>temporal_class</th>
                                        <th>EB_proteome</th>
                                        <th>eggNOG</th>
                                        <th>comment</th>


                                    </tr>


                                    <tr>
                                        <td><a href="{% url 'rnaseq_class' rnaseq_data.0 taxon_id %}" target="_top">{{rnaseq_data.0}}</a></td>
                                        <td>{{rnaseq_data.1}}</td>
                                        <td>{{rnaseq_data.2}}</td>
                                        <td>{{rnaseq_data.3}}</td>
                                    </tr>

                                </table>

                                <table>
                                    <tr>
                                        <th>2_1</th>
                                        <th>2_2</th>
                                        <th>2_3</th>
                                        <th>48_1</th>
                                        <th>48_2</th>
                                        <th>48_3</th>
                                        <th>96_1</th>
                                        <th>96_2</th>
                                        <th>96_3</th>
                                        <th>extracellular_1</th>
                                        <th>extracellular_2</th>
                                        <th>extracellular_3</th>

                                    </tr>
                                    <tr>
                                        <td>{{rnaseq_data.4}}</td>
                                        <td>{{rnaseq_data.5}}</td>
                                        <td>{{rnaseq_data.6}}</td>
                                        <td>{{rnaseq_data.7}}</td>
                                        <td>{{rnaseq_data.8}}</td>
                                        <td>{{rnaseq_data.9}}</td>
                                        <td>{{rnaseq_data.10}}</td>
                                        <td>{{rnaseq_data.11}}</td>
                                        <td>{{rnaseq_data.12}}</td>
                                        <td>{{rnaseq_data.13}}</td>
                                        <td>{{rnaseq_data.14}}</td>
                                        <td>{{rnaseq_data.15}}</td>
                                    </tr>
                                </table>
                              </div>
                            {%endif%}


                    </div> <!-- column -->
                    <!--</div>-->



                    <table>



                        {%if pathway_data %}
                        {% for key, values in all_path.items %}
                            {% for v in values %}
                                {% if key == 'KEGG' %}
                                    <tr>
                                    <td>{{key}} (IP based)</td>
                                    <td><a href="http://www.genome.jp/kegg-bin/show_pathway?ec{{v}}">{{v}}</a></td>
                                    </tr>
                                {% elif key == 'UniPathway' %}
                                    <tr>
                                    <td>{{key}} (IP based)</td>
                                    <td><a href="http://www.unipathway.org//upa?upid={{v}}">{{v}}</a></td>
                                    </tr>
                                {% elif key == 'Reactome' %}
                                    <tr>
                                    <td>{{key}} (IP based)</td>
                                    <td><a href="http://www.reactome.org/content/detail/{{v}}">{{v}}</a></td>
                                    </tr>
                                {% elif key == 'MetaCyc' %}
                                    <tr>
                                    <td>{{key}} (IP based)</td>
                                    <td><a href="http://metacyc.org/META/NEW-IMAGE?type=NIL&object={{v}}">{{v}}</a></td>
                                    </tr>
                                {% else %}
                                    <tr>
                                    <td>{{key}} (IP based)</td>
                                    <td>{{v}}</td>
                                    </tr>
                                {% endif %}

                            {% endfor %}
                        {% endfor %}
                        {% endif %}

                    </table>
                </div>
                <div class="tab-pane" id="tab3" width="100%" height="100%">


                  <div class="row" style="padding-top:15px;">
                    <div class="col-lg-6">

                      <div class="row">
                        <div class="panel panel-default">
                          <div class="panel-heading">
                            <h3 class="panel-title">Protein Sequence</h3>
                          </div>
                          <div class="panel-body">
                            <p style="word-wrap: break-word;" class="text-justify">{{ data.13 }}</p>
                          </div>
                        </div>

                      </div>
                      <div class="row">

                        <div class="panel panel-default">
                          <div class="panel-heading">
                            <h3 class="panel-title">Flanking regions ( +/- flanking 50bp)</h3>
                          </div>
                          <div class="panel-body">
                            <p style="word-wrap: break-word;" class="text-justify">{{ seq|safe }}</p>
                          </div>
                        </div>
                      </div>

                    </div>
                  </div>

                </div>
                <div class="tab-pane" id="tab2" width="100%" height="100%">

                   <h3>Interpro</h3>

                    <table>
                        <tr>
                            <th id="entete">Analysis</th>
                            <th>signature_accession</th>
                            <th>signature_description</th>
                            <th>start</th>
                            <th>stop</th>
                            <th>score</th>
                            <th>interpro_accession</th>
                            <th>interpro_description</th>
                        </tr>

                        {% for values in interpro_data_detail %}
                        <tr>
                            <td>{{values.0}}</td>

                            {% if values.0 == 'SUPERFAMILY' %}
                               <td><a href="http://supfam.cs.bris.ac.uk/SUPERFAMILY/cgi-bin/scop.cgi?ipid={{values.1}}" target="_parent">{{values.1}}</a></td>

                             {% elif values.0 == 'Pfam' %}
                               <td><a href="http://pfam.xfam.org/family/{{values.1}}" target="_parent">{{values.1}}</a></td>

                             {% elif values.0 == 'SMART' %}
                               <td><a href="http://smart.embl-heidelberg.de/smart/do_annotation.pl?ACC={{values.1}}&BLAST=DUMMY" target="_parent">{{values.1}}</a></td>

                             {% elif values.0 == 'Gene3D' %}
                               <td><a href="http://www.cathdb.info/version/latest/superfamily/{{values.1|slice:"6:"}}" target="_parent">{{values.1}}</a></td>

                             {% elif values.0 == 'ProSiteProfiles' %}
                               <td><a href="http://prosite.expasy.org/{{values.1}}" target="_parent">{{values.1}}</a></td>

                             {% elif values.0 == 'ProSitePatterns' %}
                               <td><a href="http://prosite.expasy.org/{{values.1}}" target="_parent">{{values.1}}</a></td>

                             {% elif values.0 == 'PRINTS' %}
                               <td><a href="http://www.bioinf.manchester.ac.uk/cgi-bin/dbbrowser/sprint/searchprintss.cgi?display_opts=Prints&category=None&queryform=false&prints_accn={{values.1}} " target="_parent">{{values.1}}</a></td>

                             {% elif values.0 == 'TIGRFAM' %}
                               <td><a href="http://www.jcvi.org/cgi-bin/tigrfams/HmmReportPage.cgi?acc={{values.1}}" target="_parent">{{values.1}}</a></td>

                            {% else %}
                                 <td>{{values.1}}</td>

                            {% endif %}
                            <td>{{values.2}}</td>
                            <td>{{values.3}}</td>
                            <td>{{values.4}}</td>
                            <td>{{values.5}}</td>

                            {% if values.6 != '0' %}

                               <td><a href="http://www.ebi.ac.uk/interpro/entry/{{values.6}}">{{values.6}}</a></td>
                               <td>{{values.7}}</td>
                            {% else %}
                               <td>-</td>
                            {% endif %}

                        </tr>
                        {% endfor %}

                    </table>
                    {% static "" as baseUrl %}
                    {% if interpro_protein %}
                        <iframe src="{{ baseUrl }}/interpro/{{data.2}}.html" width="100%" height="2000px" frameborder="0" hspace="0" vspace="0" scrolling="no"></iframe>
                    {% else %}
                        <iframe src="{{ baseUrl }}/interpro/{{data.1}}.html" width="100%" height="2000px" frameborder="0" hspace="0" vspace="0" scrolling="no"></iframe>
                    {% endif %}

                </div>



            <div class="tab-pane" id="tab33">
            <!-- if only group information is asked, homologs tabs become the active tab -->
        {% else %}

            <div class="tab-pane active" id="tab33">
        {% endif %}

        <div class="container-fluid">
          <div class="col-lg-12">
            {% if not orthologs %}
                <h2>Homologs</h2>
                No homologs
            {% else %}
              <div style="padding-top:20px">
                <div class="panel panel-default">
                  <div class="panel-heading">
                    <h3 class="panel-title">Homologs</h3>
                  </div>
                  <div class="panel-body">
                    {{homologues|length}} homologs were identified in {{ data.8 }} genomes with OrthoFinder (REF).
                  </div>
                </div>
              </div>

            {% endif %}
                <div class="row">
                        <div id="export_bouttons">
                            <a download="biodb_search.xls" href="#" onclick="return ExcellentExport.excel(this, 'homologues_table', 'search');" style="background-color:#DCFFF0;color:black;padding:2px;border:1px solid black;">Export to Excel</a>
                            <a download="biodb_search.csv" href="#" onclick="return ExcellentExport.csv(this, 'homologues_table');" style="background-color:#DCFFF0;color:black;padding:2px;border:1px solid black;"">Export to CSV</a>
                        <br/>
                        </div>

                       <table class="display dataTable" id="homologues_table"> <!--  class="sortable" -->
                            <thead>
                                <tr>
                                    <th></th>
                                    <th>Locus tag</th>
                                    <th>ID(%)</th>
                                    <th>Uniprot Status</th>
                                    <th>Annot. score</th>
                                    <th>Gene (uniprot/refseq)</th>
                                    <th>TM</th>
                                    <th>SP</th>
                                    <th>Organism</th>
                                    <th>Product (uniprot/refseq)</th>
                                    <th>Function</th>

                                </tr>
                            </thead>
                            <tbody>
                                {% for values in homologues %}

                                <!-- 1locus_tag,2gene,3product,4organism ,5orthogroup_size,6n_genomes,7TM,8SP,9comment_function-->
                                <!-- 10gene  | 11annotation_score | 12uniprot_status | 13recommendedName_fullName -->

                                    <tr>
                                        <td>{{values.0}}</td>
                                        <td><a href="{% url 'locusx' values.1 True %}" target="_top">{{values.1}}</a></td>
                                        <td>{{values.14}}</td> <!-- identity -->
                                        {% if values.12 != 'reviewed'%}
                                            <td>UR </td> <!-- review <img src="{{ STATIC_URL }}scales/unreviewed.gif" id="uw">-->
                                        {%else%}
                                            <td style="color:red">RW </td>  <!-- review <img src="{{ STATIC_URL }}scales/reviewed.gif" id="rw">-->
                                        {%endif%}
                                        <td>{{values.11}}</td> <!-- annotation score -->


                                        <td>{{values.2}} <br> {{values.10}}</td> <!-- gene -->
                                        <td>{{values.7}}</td> <!-- tm -->
                                        <td>{{values.8}}</td> <!-- sp -->
                                        <td>{{values.4}}</td> <!-- organism -->
                                        <td>{{values.13}} <br> {{values.3}}</td> <!-- gene -->
                                        <td>{{values.9}}</td> <!-- gene -->
                                    </tr>

                                {% endfor %}
                            </tbody>
                        </table>
                      </div>
                    </div>
            </div>
          </div>
        </div>

            {% if align_path %}
            <div class="tab-pane" id="tab55">
                            <h3>Multiple Sequence Alignment</h3>
                            <table>

                                <tr>
                                    {%if homologues|length < 200 %}
                                    <script src="https://cdn.bio.sh/msa/latest/msa.min.gz.js"></script>

                                    <div id="msa">Loading Multiple Alignment...</div>

                                    <script>
                                    var getKeys = function(obj){
                                       var keys = [];
                                       for(var key in obj){
                                          keys.push(key);
                                       }
                                       return keys;
                                    };

                                    var m = msa({
                                        importURL: "{% static alignment_fasta %}",
                                        el: document.getElementById("msa"),
                                        bootstrapMenu: true
                                    });

                                    var w = $(window).width();
                                    var h = $(window).height();
                                    m.g.config.set("registerMouseHover", "True");
                                    m.g.zoomer.set("alignmentHeight", h*0.55);
                                    m.g.zoomer.set("alignmentWidth", w*0.73);
                                    m.g.zoomer.set("overviewboxPaddingTop", "10");
                                    m.g.zoomer.set("boxRectHeight", 1);
                                    m.g.zoomer.set("boxRectWidth", 1);
                                    m.g.zoomer.set("labelFontsize", 11);
                                    m.g.zoomer.set("rowHeight", 11);
                                    m.g.zoomer.set("columnWidth", 11);
                                    m.g.vis.set("overviewbox", "True");

                                    m.g.on("row:click", function(data){
                                        window.open("{% url 'locusx' %}" + m.seqs.at(data.seqId).attributes['name'] + "/True")
                                    });
                                    msa.g.on("row:hover", function(data){
                                        console.log(data.seqId)

                                    });

                                    m.render();
                                    </script>



                                    {%else%}
                                    <script src="https://cdn.bio.sh/msa/latest/msa.min.gz.js"></script>
                                        Alignment larger than 200 sequences, only overview.
                                        <div id="msa">Loading Multiple Alignment...</div>
                                    <script>
                                    var getKeys = function(obj){
                                       var keys = [];
                                       for(var key in obj){
                                          keys.push(key);
                                       }
                                       return keys;
                                    };

                                    var m = msa({
                                        importURL: "{% static alignment_fasta %}",
                                        el: document.getElementById("msa"),
                                        bootstrapMenu: true
                                    });

                                    var w = $(window).width();
                                    var h = $(window).height();
                                    m.g.config.set("registerMouseHover", false);
                                    m.g.zoomer.set("alignmentHeight", h*0.45);
                                    m.g.zoomer.set("alignmentWidth", w*0.73);
                                    m.g.zoomer.set("boxRectHeight", 1);
                                    m.g.zoomer.set("boxRectWidth", 1);
                                    m.g.zoomer.set("rowHeight", 1);
                                    m.g.zoomer.set("columnWidth", 1);
                                    m.g.vis.set("overviewbox", false);
                                    m.g.vis.set("sequences", true);
                                    m.g.vis.set("leftHeader", false);
                                    m.g.vis.set("labels", false);
                                    m.g.vis.set("labelName", false);
                                    m.g.vis.set("labelId", false);
                                    m.render();
                                    </script>



                                    {%endif%}





                                </tr>


                            </table>
            </div>
            {% endif %}
            <div class="tab-pane" id="tab66" style="height:2px;" >
            <iframe name="orthoIDframe" id="theFrame" style="height:8000px;overflow:hidden;" width="500px" height="8800px" frameborder="0" hspace="0" vspace="0" scrolling="no"></iframe>
            </div>
            {% if pubmed_data  %}
                <div class="tab-pane" id="tab22" style="height:2px;" >

                    <table>

                        {% for row in pubmed_data%}
                            <tr>
                                <td><a href="https://www.ncbi.nlm.nih.gov/pubmed/{{row.0}}"><font size="2">{{row.2}}</font>
                                    <br>
                                    {{row.4}}
                                    </font></a></td>
                                <td>{{row.1}}</td>


                            </tr>
                            <tr>
                                <td colspan="3">{{row.3}}</td>
                            </tr>

                        {%endfor%}
                    </table>

                </div>
            {% endif %}
        </div>
        {% endif %}




    </div>
</div>





<!--

<script>
  var update_fields = function () {
    if ($("#id_plot_region").is(":checked")) {

        $('#id_region_size').prop('disabled', false);
    }
    else {

       $('#id_region_size').prop('disabled', 'disabled');
    }
  };
  $(update_fields);
  $("#id_plot_region").change(update_fields);
</script>
-->
<style>
#description_field{
    width:100px;


}

</style>

</body>

<script>

$(document).ready(function() {
    $('#homologues_table').DataTable( {
        dom: 'Bfrtip',
        columnDefs: [
            {
                targets: 6,
                visible: true
            },
            {
                targets: 8,
                visible: true
            },
            {
                targets: 9,
                visible: true
            }
        ],
        buttons: [
            {
                extend: 'colvis',
                columns: ':not(.noVis)'
            }
        ],
        "pageLength": 10
    } );
} );

$(document).ready(function(){
    $('[data-toggle="tooltip"]').tooltip();
});



//var FeatureViewer = require("feature-viewer");
//Create a new Feature Viewer and add some rendering options

window.onload = function() {
    //Create a new Feature Viewer and add some rendering options
    var ft2 = new FeatureViewer("{{ data.13 }}","#div_features", {
        showAxis: true,
        showSequence: false,
        brushActive: false,
        toolbar:false,
        bubbleHelp:true,
        zoomMax:1
                });


    //Beside positions of each element, you can also give a specific description, which will appears in the tooltip when mouse hover, and a specific ID, for example to link a click event on the feature with something else in your project.

    {{features_js|safe}}

    {{phobius_features|safe}}

    {{superfamily_features|safe}}

    ft2.on('all',function(name,data){var obj = {name: name, data: data};if(inIframe()){ parent.postMessage(obj, "*") }})
    ft2.onAll(function(name,data){
        console.log(arguments);
    });


};





function inIframe(){try{return window.self!==window.top}catch(e){return true}}
</script>
{% include "chlamdb/style_menu.html" %}
</html>
