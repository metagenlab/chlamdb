<!DOCTYPE html>


<html>



<head>
    {% load staticfiles %}
    {% load static %}
    {% get_static_prefix as STATIC_PREFIX %}
    {% load custom_tags %}

    <script type="text/javascript" src="{% static 'js/tableExport.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/jquery.base64.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/jquery.tablesorter.js' %}"></script>
    <!--<script type="text/javascript" src="{% static 'js/jquery-1.11.2.min.js' %}"></script>-->
    <script type="text/javascript" src="{% static 'js/sorttable.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/excellentexport.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/jquery.chained.min.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/jquery.min.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/bootstrap.min.js' %}"></script>

    <script type="text/javascript" src="{% static 'js/jvenn.min.js' %}"></script>
    <link rel="stylesheet" type="text/css" href="{% static 'css/bootstrap.css' %}" />
    <link rel="stylesheet" type="text/css" href="{% static 'css/style.css' %}" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js" charset="utf-8"></script>

    <script type="text/javascript" src="{% static 'js/bootstrap-switch.js' %}"></script>
    <link rel="stylesheet" type="text/css" href="{% static 'css/toggle-switch.css' %}" />

</head>
<body>

    <div id="container">


        <div id="sidebar">
            {% include "chlamdb/menu.html" %}
        </div>

        <div id="header">
            {% include "chlamdb/user.html" %}
        </div>

        <div id="content">

                   <nav>
                        <ul id="tabs_main" class="nav nav-tabs">
                            <li><a href="{% url 'kegg_module' biodb %}">Category Heatmap</a></li>
                            <li><a href="{% url 'kegg_module_subcat' biodb %}">Sub Category Heatmap</a></li>
                            <li class="active"><a href="{% url 'module_comparison' biodb %}">Compare strains</a></li>
                        </ul>
                    </nav>

            <form action='{% url "module_comparison" biodb %}' method="post">
                {% csrf_token %}
                {{ form.as_p }}
                <input type="submit" value="Submit" />

            </form>

            {% if envoi_comp %}
                    <div id="export_bouttons" style="float:left">
                        <a download="biodb_search.xls" href="#" onclick="return ExcellentExport.excel(this, 'table_modules', 'search');" style="background-color:#DCFFF0;color:black;padding:2px;border:1px solid black;">Export to Excel</a>
                        <a download="biodb_search.csv" href="#" onclick="return ExcellentExport.csv(this, 'table_modules');" style="background-color:#DCFFF0;color:black;padding:2px;border:1px solid black;"">Export to CSV</a>
                    <br/>
                    </div>
                    <table class="sortable" id="table_modules">
                            <style>
                table {
                    width:100%;
                    table-layout:fixed;
                }
                td {
                    overflow: hidden;
                    white-space: nowrap;
                }
            </style>
                    <tr>
                        <th id="entete_meta6">Category</th>
                        <th id="entete_meta5">SubCategory</th>
                        <th id="entete_meta2" >Map</th>
                        <th id="entete_meta3">Description</th>
                        <th id="entete_meta4">nKO</th>
                        <th id="entete_meta4">nKO+</th>
                        <th id="entete_meta4">%</th>
                        {% for taxon in taxon_list %}
                            <th id="entete_meta4" valign="bottom"><div class="rotate">{{ taxon_id2description|keyvalue:taxon}}</div></th>
                        {% endfor %}
                    <tr>
                    {% for category, values in category2maps.items %}
                        {% for value0, value1 in values %}
                        <tr>

                            <td>{{category}}</td><td>{{module2sub_category|keyvalue:value0}}</td>
                            <td><a href="http://www.genome.jp/dbget-bin/www_bget?md:{{value0}}" target="_top">{{value0}}</a>
                                <a href="{% url 'KEGG_module_map' biodb value0 %}">link</a></td>
                            <td>{{value1}}</td>
                            {% for value in map2count|keyvalue:value0 %}
                                <td>{{value}}</td>
                            {% endfor %}
                            {%for map_dico in taxon_maps %}
                                <td data-hist="{{map_dico|keyvalue:value0}}">{{map_dico|keyvalue:value0}}</td>
                            {% endfor %}

                        </tr>
                        {% endfor %}
                    {% endfor %}
                    </table>
            {% endif %}
        </div>
    </div>

    <script src="{% static 'js/jquery.hottie.js' %}"></script>
    <script>
      $(function(){


        $("#table_modules td").hottie({
          readValue : function(e) {
            return $(e).attr("data-hist");
          },
        colorArray : [
        "#5858FA",
            "#FBEFEF",
            "#FA5858"
        ]

        });

      });
    </script>

</body>

</html>
