<!DOCTYPE html>


<html>

<head>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-125948409-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-125948409-1');
</script>

    {% load staticfiles %}
    {% load static %}

{% include "chlamdb/header.html" %}

</head>

<body>
    <div class="container-fluid" id="main_container">
      <div class="row">
        <div id="wrapper">
            <div id="page-content-wrapper">
              <div class="row">
                <div class="col-lg-12">
                   {% include "chlamdb/menu.html" %}
                    <ul id="tabs" class="nav nav-tabs" data-tabs="tabs">
                        <li class="active"><a href="#tab2" data-toggle="tab">Home</a></li>
                        <li><a href="#tab0" data-toggle="tab">Genomes</a></li>
                        <li><a href="#tab1" data-toggle="tab">Phylogeny</a></li>
                    </ul>


                    <div id="my-tab-content" class="tab-content">
                        <div class="tab-pane active" id="tab2">


                            <div style="padding-top:20px;">
                                <div class="jumbotron">
                                <h1> Welcome to the Chlamydiae database ! </h1>
                                <p>
                                Representative genomes of each species (n=XX) of the Planctomycetes-Verrucomycrobia-Chlamydiae superphylum were included in this database (created on the XX-XX-XXXX).

                                A manuscript is currently being prepared (T. pillonel et al.). Before publishing data acquired from our database, please check again if the manuscript is available (the link for the publication will be displayed here).
                              </p>
                                <a id="learn_more" class="btn btn-success btn-lg" href="#" role="button">Learn more</a>

                                </div>
                              </div>
                            <div class="row">
                              <div class="col-lg-6">
                                <div class="panel panel-default">
                                  <div class="panel-heading">
                                    <h3 class="panel-title">General searches</h3>
                                  </div>
                                  <div class="panel-body">
                                    First, gene names, gene products, locus tags, protein domains (InterPro or PFAM),
                                      Clusters of orthologous genes (COGs), Kegg Orthology numbers (KO) or EC numbers can be queried using the search function at the top of the page.
                                      [[https://chlamdb.ch/search][Searches]]
                                      The locus page
                                  </div>
                                </div>
                              </div>
                              <div class="col-lg-6">
                                <div class="panel panel-default">
                                  <div class="panel-heading">
                                    <h3 class="panel-title">Comparative analyses</h3>
                                  </div>
                                  <div class="panel-body">
                                    Several comparisons are available:
                                    <ul>
                                      <li> [[./orthogroups.txt][Orthologous groups comparisons]] </li>

                                      <li> [[./cog.txt][Cluster of orthologous genes (COGs) comparisons]] </li>

                                      <li> [[./pfam.txt][Pfam domains]] </li>

                                      <li> [[./interpro.txt][InterPro entries]] </li>

                                      <li> [[./ec.txt][EC numbers]] </li>

                                      <li> [[./kegg.txt][Kegg Orthologs]] </li>

                                      <li> [[./pairwise.txt][Pairwise identity]] </li>

                                      <li> [[./cds_length.txt][Coding Sequences lengths]] </li>

                                      <li> [[./transporters.txt][Transporters]] </li>
                                    </ul>
                                  </div>
                                </div>
                              </div>

                              <div class="row">
                                <div class="col-lg-6">
                                  <div class="panel panel-default">
                                    <div class="panel-heading">
                                      <h3 class="panel-title">Genome alignments </h3>
                                    </div>
                                    <div class="panel-body">
                                      Genome alignments of specific regions or of whole genomes can be performed:

                                        - Genomic Region <br>

                                        - Whole-genome alignments <br>
                                    </div>
                                  </div>
                                </div>
                                <div class="col-lg-6">
                                  <div class="panel panel-default">
                                    <div class="panel-heading">
                                      <h3 class="panel-title">Metabolism comparisons</h3>
                                    </div>
                                    <div class="panel-body">
                                      Panel content
                                    </div>
                                  </div>
                                </div>
                              </div>

                              <div class="row">
                                <div class="col-lg-6">
                                  <div class="panel panel-default">
                                    <div class="panel-heading">
                                      <h3 class="panel-title">Secretion system effectors</h3>
                                    </div>
                                    <div class="panel-body">
                                      The proteins secreted by the type-III secretion play a major role in the host-bacterial interaction. These are call effectors and tend to exhibit eukariotic proteins domains allowing the interaction with host proteins.

                                    </div>
                                  </div>
                                </div>
                                <div class="col-lg-6">
                                  <div class="panel panel-default">
                                    <div class="panel-heading">
                                      <h3 class="panel-title">Transporters</h3>
                                    </div>
                                    <div class="panel-body">
                                      Transporters were annotated using XXX
                                    </div>
                                  </div>
                                </div>
                              </div>

                              <div class="row">
                                <div class="col-lg-6">
                                  <div class="panel panel-default">
                                    <div class="panel-heading">
                                      <h3 class="panel-title">Genome statistics</h3>
                                    </div>
                                    <div class="panel-body">
                                      <ul>

                                        <li> General genomic features </li>

                                        <li> Maximum-likelihood core-genome phylogeny </li>

                                        <li> Pairwise identities comparisons </li>

                                        <li> Coding Sequence lengths comparisons </li>
                                      </ul>

                                    </div>
                                  </div>
                                </div>
                                <div class="col-lg-6 col-md-8 col-sm-8">
                                  <div class="panel panel-default">
                                    <div class="panel-heading">
                                      <h3 class="panel-title">BlastNR</h3>
                                    </div>
                                    <div class="panel-body">
                                      Each coding sequence was BLASTed (using BLASTP) against the nun-redundant protein database of the National Center for Biotechnology Information.
                                    </div>
                                  </div>
                                </div>
                              </div>

                            </div>


                        </div>
                        <div class="tab-pane" id="tab0">
                          <div class="col-lg-12 col-md-12 col-sm-12">
                           <div class="row">
                            <div id="export_bouttons">
                                <a download="biodb_search.xls" href="#" onclick="return ExcellentExport.excel(this, 'genomes_table', 'search');" style="background-color:#DCFFF0;color:black;padding:2px;border:1px solid black;">Export to Excel</a>

                                <a download="biodb_search.csv" href="#" onclick="return ExcellentExport.csv(this, 'genomes_table');" style="background-color:#DCFFF0;color:black;padding:2px;border:1px solid black;"">Export to CSV</a>
                                <br/>
                            </div>

                            <table class="display" id="genomes_table">
                                <thead>


                                    <tr>
                                        <th>Accession</th>
                                        <th>GC</th>
                                        <th>N proteins</th>
                                        <th>N contigs</th>
                                        <th>Size</th>
                                        <th>Percent non coding</th>
                                        <th>Organism</th>
                                        <th>Browse Online</th>
                                        <th>gbk</th>
                                        <th>faa</th>
                                        <th>fna</th>
                                        <th>ffn</th>
                                        <th>tab</th>

                                    </tr>
                                 </thead>
                                 <tbody>
                                 {% for values in genomes_data %}

                                    <tr>
                                        <td><a href="http://www.ncbi.nlm.nih.gov/nuccore/{{values.0}}">{{values.0}}</a></td>
                                        <td>{{values.1}}</td>
                                        <td>{{values.2}}</td>
                                        <td>{{values.3}}</td>
                                        <td>{{values.4}}</td>
                                        <!--<td>{{values.5}}</td>-->
                                        <!--<td>{{values.6}}</td>-->
                                        <!--<td>{{values.7}}</td>-->
                                        <!--<td>{{values.8}}</td>-->
                                        <td>{{values.9}}</td>
                                        <td>{{values.13}}</td>
                                        <td><a href="{% url 'genome_annotation' values.0 %}">{{values.0}}</a></td>

                                        <td style="vertical-align:top" nowrap>
                                            <a  style="text-decoration:none;" href="{% url 'get_record' values.0 'gbk' %}">
                                            <span style="background-color:#DCFFF0;color:black;padding:1px;">GBK</span></a>
                                        </td>

                                        <td nowrap>
                                            <a  style="text-decoration:none;" href="{% url 'get_record' values.0 'faa' %}"">
                                            <span style="background-color:#DCFFF0;color:black;padding:1px;">FAA</span></a>
                                        </td>

                                        <td nowrap>
                                            <a  style="text-decoration:none;" href="{% url 'get_record' values.0 'fna' %}"">
                                            <span style="background-color:#DCFFF0;color:black;padding:1px;">FNA</span></a>
                                        </td>

                                        <td nowrap>
                                            <a  style="text-decoration:none;" href="{% url 'get_record' values.0 'ffn' %}"">
                                            <span style="background-color:#DCFFF0;color:black;padding:1px;">FFN</span></a>
                                        </td>

                                        <td nowrap>
                                            <a  style="text-decoration:none;" href="{% url 'get_record' values.0 'gbk' %}">
                                            <span style="background-color:#DCFFF0;color:black;padding:1px;">TAB</span></a>

                                    </tr>

                                 {% endfor %}

                                </tbody>
                            </table>
                        </div><!-- row -->
                      </div> <!-- col -->
                    </div> <!-- tab0 -->
                        <div class="tab-pane" id="tab1">
                          <div class="row">
                            <div class="col-lg-12">
                              <div class="row">
                                <a download="profile.svg" class="btn" href="{% static asset_path %}"><i class="fa fa-download"></i> Download SVG</a>
                                <a onclick="exportPNG();" class="btn" id="png_button"><i class="fa fa-download"></i> Download PNG</a>
                              </div>
                              <div>
                                <object type="image/svg+xml" data="{% static asset_path %}" id="pyhlogeny" style="width:1000px"></object>
                              </div>
                            </div>
                          </div>
                        </div> <!- tab1 -->
                    </div>  <!--tab content -->
                    <!--<img src="{% static 'chlam_tree.png' %}" width="80%"-->
                </div> <!--col -->
              </div> <!--row -->
            </div> <!--page-content-wrapper -->
        </div> <!--wrapper -->
      </div> <!--container -->
    </div> <!--container -->

    <script>
      $(document).ready(function() {
      $('#genomes_table').DataTable( {
      dom: 'Bfrtip',  
      "paging":   true,
      "ordering": true,
      "info":     false,
      buttons: [
        {
            extend: 'excel',
            title: 'interaction_table'
        },
        {
            extend: 'csv',
            title: 'interaction_table'
        }
      ],
      } );
      } );
    $('.dropdown-toggle').dropdown()
    </script>


</body>
{% include "chlamdb/style_menu.html" %}

<script>

var exportPNG = function() {

    /*
    Based off  gustavohenke's svg2png.js
    https://gist.github.com/gustavohenke/9073132
    */

var a = document.getElementById("pyhlogeny");
console.log(a)
// Get the SVG document inside the Object tag
var svgDoc = a.contentDocument;
    var svgData = new XMLSerializer().serializeToString( svgDoc );

    var canvas = document.createElement( "canvas" );
    var ctx = canvas.getContext( "2d" );
    var dataUri = '';
    try {
        dataUri = 'data:image/svg+xml;base64,' + btoa(svgData);
    } catch (ex) {

        // For browsers that don't have a btoa() method, send the text off to a webservice for encoding
        /* Uncomment if needed
        $.ajax({
            url: "http://www.mysite.com/webservice/encodeString",
            data: { svg: svgData },
            type: "POST",
            async: false,
            success: function(encodedSVG) {
                dataUri = 'data:image/svg+xml;base64,' + encodedSVG;
            }
        })
        */

    }

    var img = document.createElement( "img" );

    img.onload = function() {
        ctx.canvas.width  = img.naturalWidth;
        ctx.canvas.height = img.naturalHeight;
        ctx.fillStyle = "#ffffff";
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        ctx.drawImage( img, 0, 0 );


        try {

            // Try to initiate a download of the image
            var a = document.createElement("a");
            a.download = "phylogeny.png";
            a.href = canvas.toDataURL("image/png");
            document.querySelector("body").appendChild(a);
            a.click();
            document.querySelector("body").removeChild(a);

        } catch (ex) {

            // If downloading not possible (as in IE due to canvas.toDataURL() security issue)
            // then display image for saving via right-click

            var imgPreview = document.createElement("div");
            imgPreview.appendChild(img);
            document.querySelector("body").appendChild(imgPreview);

        }
    };
    img.src = dataUri;

}


</script>

</html>
