<!DOCTYPE html>


<html>



<head>
    {% load staticfiles %}
    {% load static %}
    {% get_static_prefix as STATIC_PREFIX %}
    {% load custom_tags %}





</head>



<body height="5000px">

    <div id="container">


        <div id="sidebar">
            {% include "chlamdb/menu.html" %}
        </div>

        <div id="header">
            {% include "chlamdb/user.html" %}
        </div>

        <div id="content">
            <nav>
                <ul id="tabs_main" class="nav nav-tabs">
                    <li><a href="{% url 'extract_orthogroup' biodb %}">Detailed comparison</a></li>
                    <li><a href="{% url 'venn_orthogroup' biodb %}">Venn diagram</a></li>
                    <li class="active"><a href="{% url 'orthogroup_comparison' biodb %}">Compare Orthogroups size between genomes</a></li>

                </ul>
            </nav>

                <div class="panel panel-success" style="width:80% ; top: 200px; margin: 10px 10px 10px 10px">
                    <div class="panel-heading" style="width:100%">
                        <h3 class="panel-title">Help</h3>
                    </div>
                    <p style="margin: 10px 10px 10px 10px; line-height: 160%">Compare orthogroup presenting more than one homolog in one of the selected genomes</p>
                </p>
                </div>



                <form action='{% url "chlamdb.views.orthogroup_comparison" biodb %}' method="post">
                    {% csrf_token %}
                    {{ form.as_p }}
                    <input type="submit" value="Submit" />

                </form>

                {% if envoi_comp %}

                <div class="panel panel-success" style="width:80% ; top: 200px; margin: 10px 10px 10px 10px">
                    <div class="panel-heading" style="width:100%">
                        <h3 class="panel-title">Help</h3>
                    </div>
                    <p style="margin: 10px 10px 10px 10px; line-height: 160%">Homolog counts can be reordrered by clicking on column headers.<br>
                    <strong>Total count:</strong> number of homologs in the whole database </p>
                </p>
                </div>

                        Number of orthogroups exhiniting > 1 copy in at least 1/{{taxon_list|length}} genome: {{orthogroups2counts|length}}

                        <table class="sortable" id="mytable">
                            <style>
                            table {
                            width:100%;
                            table-layout:fixed;
                            }
                            td {
                            overflow: hidden;
                            white-space: nowrap;
                            }
                            </style>
                            <tr>
                                <th id="entete_meta" >Orthogroup</th>
                                <th id="entete_meta3">Total count</th>
                                {% for taxon in taxon_list %}
                                    <th id="entete_meta4" valign="bottom"><div class="rotate">{{ taxon_id2description|keyvalue:taxon}}</div></th>
                                {% endfor %}
                                <th id="entete_meta3">Annot</th>
                            <tr>
                            {% for key, values in orthogroups2counts.items %}
                                <tr> <td><a href="{% url 'locusx' biodb key True%}">{{key}}</a></td>
                                    <td>{{orthogroups2total_count|keyvalue:key}}</td>
                                    {% for taxon_count in values%}
                                          {%if taxon_count != 0 %}
                                          <td data-hist="{{taxon_count}}">{{taxon_count}}</td>
                                          {% else %}
                                           <td>{{taxon_count}}</td>
                                          {% endif %}
                                    {% endfor %}
                                    <td>
                                    {% for values in group2annot|keyvalue:key %}
                                        {{values.0}}({{values.1}})<br/>
                                    {%endfor%}
                                    </td>
                                </tr>
                        {% endfor %}
                        </table>



                {% endif %}

        </div>
    </div>


</body>
<script src="{% static 'js/jquery.hottie.js' %}"></script>
                        <script>
                        $(function(){
                        $("#mytable td").hottie({
                        readValue : function(e) {
                        return $(e).attr("data-hist");
                        },
                        colorArray : [
                        "#5858FA",
                        "#FBEFEF",
                        "#FA5858"
                        ]

                        });

                        });
                        </script>

</html>

