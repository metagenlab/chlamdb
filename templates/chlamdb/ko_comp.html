<!DOCTYPE html>


<html>



<head>
    {% load staticfiles %}
    {% load static %}
    {% get_static_prefix as STATIC_PREFIX %}
    {% load custom_tags %}





</head>



<body height="5000px">

    <div id="container">


        <div id="sidebar">
            {% include "chlamdb/menu.html" %}
        </div>

        <div id="header">
            {% include "chlamdb/user.html" %}
        </div>

        <div id="content">
            <nav>
                <ul id="tabs_main" class="nav nav-tabs">
                    <li><a href="{% url 'extract_ko' biodb %}">Detailed comparison</a></li>
                    <li><a href="{% url 'venn_orthogroup' biodb %}">Venn diagram</a></li>
                    <li class="active"><a href="{% url 'ko_comparison' biodb %}">Compare KO counts</a></li>

                </ul>
            </nav>
                <form action='{% url "chlamdb.views.ko_comparison" biodb %}' method="post">
                    {% csrf_token %}
                    {{ form.as_p }}
                    <input type="submit" value="Submit" />

                </form>

                {% if envoi_comp %}
                    <ul>
                        <li>Number of KO: {{ko2counts|length}} (at least present 1 time in one of the selected genomes).</li>
                    </ul>
                        <table class="sortable" id="mytable">
                            <style>
                            table {
                            width:100%;
                            table-layout:fixed;
                            }
                            td {
                            overflow: hidden;
                            white-space: nowrap;
                            }
                            </style>
                            <tr>
                                <th id="entete_meta" >Orthogroup</th>
                                <th id="entete_meta3">Total count</th>
                                {% for taxon in taxon_list %}
                                    <th id="entete_meta4" valign="bottom"><div class="rotate">{{ taxon_id2description|keyvalue:taxon}}</div></th>
                                {% endfor %}
                                <th id="entete_meta3">Annot</th>
                            <tr>
                            {% for key, values in ko2counts.items %}
                                <tr> <td><a href="{% url 'fam' biodb key 'ko' %}" target="_top">{{key}}</a></td>
                                    <td>{{ko2total_count|keyvalue:key}}</td>
                                    {% for taxon_count in values%}
                                          {%if taxon_count != 0 %}
                                          <td data-hist="{{taxon_count}}">{{taxon_count}}</td>
                                          {% else %}
                                           <td>{{taxon_count}}</td>
                                          {% endif %}
                                    {% endfor %}
                                    <td>{{ ko2annot|keyvalue:key }}</td>
                                </tr>
                        {% endfor %}
                        </table>



                {% endif %}

        </div>
    </div>


</body>
<script src="{% static 'js/jquery.hottie.js' %}"></script>
                        <script>
                        $(function(){
                        $("#mytable td").hottie({
                        readValue : function(e) {
                        return $(e).attr("data-hist");
                        },
                        colorArray : [
                        "#5858FA",
                        "#FBEFEF",
                        "#FA5858"
                        ]

                        });

                        });
                        </script>

</html>

